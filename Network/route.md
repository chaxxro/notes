# 路由协议

首先通过 IP 协议来判断两台主机是否在同一个子网中，如果在同一个子网，就通过 ARP 协议查询对应的 MAC 地址，然后以广播的形式向该子网内的主机发送数据包；如果不在同一个子网，以太网会将该数据包转发给本子网的网关进行路由

网关是互联网上子网与子网之间的桥梁，所以网关会进行多次转发，最终将该数据包转发到目标IP所在的子网中，然后再通过 ARP 获取目标机 MAC，最终也是通过广播形式将数据包发送给接收方

完成这个路由协议的物理设备就是路由器，路由器会根据信道情况，选择并设定路由，以最佳路径来转发数据包

## 路由表

路由器工作在网络层

IP 地址是逻辑地址，在不同的地理位置加入互联网就会根据 DHCP 动态分配到完全不同的 IP 地址，但由于属于网络层，相对较高的抽象层次设计的初衷就是为了简化通信，方便使用，尤其对于用户进程而言

MAC 地址是物理地址，工作在数据链路层，任何时候任何条件都不会改变，虽说使用起来不太方便，且描述的是较低层的数据链路通信细节，但在任何时候都可用于数据通信寻址

路由器负责不同网段之间的通信，每个与路由器端口相连的网络被称为一个子网或网段，也就是一个广播域

在路由器中有路由表，通过在网络节点上运行路由协议，记录并更新去往不同网段的路径信息